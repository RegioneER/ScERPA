@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@inject ScERPA.Services.Interfaces.ICommonServices commonServices
@using ScERPA.ViewModels
@model AccertamentoResidenzaViewModel
<partial name="_Esito" />
<br>
<h1>@ViewData["Title"]</h1>
<br />
<hr />
<br>

 @if (Model.risultati is not null && ViewData.ModelState.IsValid)
{
    <h2 id="lblRisultatiRicerca">Risultati della ricerca</h2>
    <br>
    <div class="px-3 mt-2">
        @if (!string.IsNullOrEmpty(Model.AccertamentoMultiplo.Pdf))
        {
            <a class="btn btn-outline-primary" role="button" download='@($"{Model.AccertamentoMultiplo.Servizio}_{@DateTime.Now.ToString("dd_MM_yyyy")}")' href="data:application/pdf;base64,@Model.AccertamentoMultiplo.Pdf">
                <span>Esporta in pdf</span>
                <svg class="icon icon-primary ms-1" aria-hidden="true">
                    <use xlink:href='@(commonServices.SpritesPath+"/sprites.svg#it-download")' href='@(commonServices.SpritesPath+"/sprites.svg#it-download")'></use>
                </svg>
            </a>
        }
        @if (!string.IsNullOrEmpty(Model.AccertamentoMultiplo.Xlsx))
        {
            <a class="btn btn-outline-primary" role="button" download='@($"{Model.AccertamentoMultiplo.Servizio}_{@DateTime.Now.ToString("dd_MM_yyyy")}")' href="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,@Model.AccertamentoMultiplo.Xlsx">
                <span>Esporta in Excel</span>
                <svg class="icon icon-primary ms-1" aria-hidden="true">
                    <use xlink:href='@(commonServices.SpritesPath+"/sprites.svg#it-download")' href='@(commonServices.SpritesPath+"/sprites.svg#it-download")'></use>
                </svg>
            </a>
        }
    </div>
    <br>
        <section name="risultatiricerca" aria-labelledby="lblRisultatiRicerca" tabindex="0">
        <br>
        @if (Model.risultati.Count > 0)
        {
            <div class="table-responsive">
               <table class="table table-striped table-hover rounded shadow">
                    <thead>
                        <tr>
                            <th scope="col">Codice Fiscale</th>
                            <th scope="col">Cognome</th>
                            <th scope="col">Nome</th>
                            <th scope="col">Data di nascita</th>
                            <th scope="col">Tipo indirizzo</th>
                            <th scope="col">Decorrenza</th>
                            <th scope="col">Nazione</th>
                            <th scope="col">Provincia</th>
                            <th scope="col">CAP</th>
                            <th scope="col">Località</th>
                            <th scope="col">Frazione</th>
                            <th scope="col">Indirizzo</th>
                            <th scope="col">Civico</th>
                            <th scope="col">Nota</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (RisultatoAccertamentoResidenzaViewModel soggetto in Model.risultati)
                        {
                            <tr id="@soggetto.Generalita.CodiceFiscale">
                                <td>@soggetto.Generalita.CodiceFiscale</td>
                                <td>@soggetto.Generalita.Cognome</td>
                                <td>@soggetto.Generalita.Nome</td>
                                <td>@soggetto.Generalita.DataNascita</td>
                                <td>@soggetto.TipoIndirizzo</td>
                                <td>
                                    @soggetto.DecorrenzaResidenza
                                </td>
                                <td>
                                    @soggetto.Nazione
                                </td>
                                <td>
                                    @soggetto.Provincia
                                </td>
                                <td>
                                    @soggetto.CAP
                                </td>
                                <td>
                                    @soggetto.Localita
                                </td>
                                <td>
                                    @soggetto.Frazione
                                </td>
                                <td>
                                    @soggetto.Indirizzo
                                </td>
                                <td>
                                    @soggetto.Civico
                                </td>                                             
                                <td>@soggetto.Errore</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
        else
        {
            <div class="alert alert-info" role="alert">
                <p>Nessun risultato</p>
            </div>
        }
    </section>
    <br>
    <hr />
    <br>
}
<partial name="_AccertamentoMultiplo" model="@Model.AccertamentoMultiplo">
@section Scripts{
    <partial name="_ValidationScriptsPartial" />
    <script src="/js/Spinner.js" ></script>

}