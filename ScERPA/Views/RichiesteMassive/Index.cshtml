@using ScERPA.ViewModels.RchiesteMassive;
@inject ScERPA.Services.Interfaces.ICommonServices commonServices

@model MassiveRequestsListViewModel;

<partial name="_Esito" />
<br />
<div>
    <h1>@ViewData["Title"]</h1>
</div>

@if (Model.Elenco.Count > 0)
{
    <div class="table-responsive rounded shadow">
        <table id="TabellaEServices" name="TabellaEServices" class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Area</th>
                    <th scope="col">Nome servizio</th>
                    <th scope="col">Finalità</th>
                    <th>Data Creazione</th>
                    <th>Data Elaborazione</th>
                    <th>Elementi</th>
                    <th>Stato</th>
                    <th>Azione</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var elemento in Model.Elenco)
                {
                    <tr>
                        <td>@elemento.Id</td>
                        <td>@elemento.Area</td>
                        <td>@elemento.Servizio</td>
                        <td>@elemento.Finalita</td>
                        <td>@elemento.DataOraCreazione</td>
                        <td>@elemento.DataOraEsecuzione</td>
                        <td>@elemento.Elementi</td>
                        <td>@elemento.Stato</td>
                        <td><a asp-action="AppendRequest" asp-route-idRichiestaMassiva="@elemento.Id" asp-route-page="@Model.paging.PageIndex">Aggiungila alle eseguibili</a></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <nav class="pagination-wrapper justify-content-center mt-3" aria-label="Pagine dei risultati di ricerca">
        <ul class="pagination">

            @if (Model.paging.PageIndex > 1)
            {
                <li class="page-item">
                    <a class="page-link" asp-action="Index" asp-route-areaId="@Model.searchPanel.AreaId" asp-route-servizioId="@Model.searchPanel.ServizioId" asp-route-denominazioneFinalita="@Model.searchPanel.DenominazioneFinalita" asp-route-page="@(Model.paging.PageIndex-1)">
                        <svg class="icon icon-primary"><use href='@(commonServices.SpritesPath+"/sprites.svg#it-chevron-left")'></use></svg>
                        <span class="visually-hidden">Pagina precedente</span>
                    </a>
                </li>
            }
            else
            {
                <li class="page-item disabled">
                    <a class="page-link" tabindex="-1" aria-hidden="true" asp-action="Index" asp-route-areaId="@Model.searchPanel.AreaId" asp-route-servizioId="@Model.searchPanel.ServizioId" asp-route-denominazioneFinalita="@Model.searchPanel.DenominazioneFinalita" asp-route-page="1">
                        <svg class="icon icon-primary"><use href='@(commonServices.SpritesPath+"/sprites.svg#it-chevron-left")'></use></svg>
                        <span class="visually-hidden">Pagina precedente</span>
                    </a>
                </li>
            }

            @for (int pageIndex = 1; pageIndex <= Model.paging.TotalPages; pageIndex++)
            {

                @if (pageIndex != Model.paging.PageIndex)
                {
                    <li class="page-item d-none d-sm-flex">
                        <a class="page-link" asp-action="Index" asp-route-areaId="@Model.searchPanel.AreaId" asp-route-servizioId="@Model.searchPanel.ServizioId" asp-route-denominazioneFinalita="@Model.searchPanel.DenominazioneFinalita" asp-route-page="@pageIndex">
                            @pageIndex
                        </a>
                    </li>
                }
                else
                {
                    <li class="page-item active">
                        <a class="page-link" aria-current="page" asp-action="Index" asp-route-areaId="@Model.searchPanel.AreaId" asp-route-servizioId="@Model.searchPanel.ServizioId" asp-route-denominazioneFinalita="@Model.searchPanel.DenominazioneFinalita" asp-route-page="@pageIndex">
                            <span class="d-inline-block d-sm-none">Pagina </span>@pageIndex
                        </a>
                    </li>
                }

            }

            @if (Model.paging.PageIndex != Model.paging.TotalPages)
            {
                <li class="page-item">
                    <a class="page-link" asp-action="Index" asp-route-areaId="@Model.searchPanel.AreaId" asp-route-servizioId="@Model.searchPanel.ServizioId" asp-route-denominazioneFinalita="@Model.searchPanel.DenominazioneFinalita" asp-route-page="@(Model.paging.PageIndex+1)">
                        <svg class="icon icon-primary"><use href='@(commonServices.SpritesPath+"/sprites.svg#it-chevron-right")'></use></svg>
                        <span class="visually-hidden">Pagina seguente</span>
                    </a>
                </li>
            }
            else
            {
                <li class="page-item disabled">
                    <a class="page-link" tabindex="-1" aria-hidden="true" asp-action="Index" asp-route-areaId="@Model.searchPanel.AreaId" asp-route-servizioId="@Model.searchPanel.ServizioId" asp-route-denominazioneFinalita="@Model.searchPanel.DenominazioneFinalita" asp-route-page="@(Model.paging.TotalPages)">
                        <svg class="icon icon-primary"><use href='@(commonServices.SpritesPath+"/sprites.svg#it-chevron-right")'></use></svg>
                        <span class="visually-hidden">Pagina seguente</span>
                    </a>
                </li>
            }

        </ul>
    </nav>
}
else
{
    <div class="alert alert-info" role="alert">
        <p>Nessuna Richiesta Massiva trovata</p>
    </div>
}
<br />

